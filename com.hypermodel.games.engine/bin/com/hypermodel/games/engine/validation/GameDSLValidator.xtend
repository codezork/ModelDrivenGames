/*
 * generated by Xtext 2.12.0
 */
package com.hypermodel.games.engine.validation

import com.google.inject.Inject
import com.hypermodel.games.engine.gameDSL.GameDSLPackage
import com.hypermodel.games.engine.gameDSL.GameRoot
import org.eclipse.xtext.naming.IQualifiedNameProvider
import org.eclipse.xtext.validation.Check

/**
 * This class contains custom validation rules. 
 *
 * See https://www.eclipse.org/Xtext/documentation/303_runtime_concepts.html#validation
 */
class GameDSLValidator extends AbstractGameDSLValidator {
	public static final String CODE__DUPLICATE_REGION_NAME = "104";

	@Inject extension IQualifiedNameProvider
	
	@Check
	def checkDuplicateTextureRegion(GameRoot game) {
		var names = <String>newHashSet
		var counter = -1;
		for (region : game.regions) {
			counter += 1
			var regionName = region.fullyQualifiedName.toString
			if (names.contains(regionName)) {
				error(String.format("Region name %s is used more than once which is disallowed!",
						regionName),
						GameDSLPackage.Literals.GAME_ROOT__REGIONS,
						counter, CODE__DUPLICATE_REGION_NAME,
						null)
			}
			names.add(regionName);
		}
	}
}
